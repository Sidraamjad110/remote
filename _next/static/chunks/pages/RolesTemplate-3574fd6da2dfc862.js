(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[496],{8734:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/RolesTemplate",function(){return r(9053)}])},9053:function(e,t,r){"use strict";r.r(t);var s=r(5893),a=r(7294),o=r(6249),n=r(50),l=r(6947);t.default=e=>{let{token:t,logout:r}=e,[i,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(""),[g,h]=(0,a.useState)(null),[m,x]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1),[w,E]=(0,a.useState)(null);(0,a.useEffect)(()=>{t&&fetchRoles()},[t]),(0,a.useEffect)(()=>{if(g){let e=setTimeout(()=>h(null),5e3);return()=>clearTimeout(e)}},[g]);let handleApiError=e=>{if(!e.success)switch(console.error("API Error:",e),e.error){case"DATA_NOT_FOUND":return"Not Found";case"BAD_REQUEST":return e.message||"Invalid input provided";case"ALREADY_EXISTS":return e.message||"Role already exists";case"CONFLICT":return e.message||"Please try again";case"FORBIDDEN":return"Access Denied";case"UNAUTHORIZED":return r(),"Please log in to continue";case"MONGO_EXCEPTION":return console.error("MongoDB Error Details:",e.details),"An error occurred";case"DB_CHECK_FAIL":return e.message||"Database error occurred";default:return"An unexpected error occurred"}return null},fetchRoles=async()=>{try{let e=await fetch("http://192.168.18.107:3000/rolepermission/api/v1/roles/list",{headers:{Authorization:"Bearer ".concat(t)}}),s=await e.json();if(401===e.status){console.log("Unauthorized - logging out"),r();return}if(!e.ok||!s.success){let e=handleApiError(s);throw Error(e||"Failed to fetch roles")}if(s.success&&1===s.type&&s.data)c(s.data.data||[]);else throw Error("Invalid response format")}catch(t){let e=t instanceof Error?t.message:"Unknown error";showMessage(e,!1),console.error("Error fetching roles:",t)}},handleCreateRole=async e=>{if(e.preventDefault(),!d.trim()){showMessage("Role name cannot be empty!",!1);return}p(!0);try{let e=await fetch("http://192.168.18.107:3000/rolepermission/api/v1/roles/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({name:d.trim()})}),s=await e.json();if(401===e.status){console.log("Unauthorized - logging out"),r();return}if(!e.ok||!s.success){let e=handleApiError(s);throw Error(e||"Failed to create role")}s.success&&1===s.type&&s.data&&(c([...i,s.data]),u(""),showMessage("Role created successfully!",!0))}catch(t){let e=t instanceof Error?t.message:"Unknown error";showMessage(e,!1),console.error("Error creating role:",t)}finally{p(!1)}},handleDeleteRole=async e=>{p(!0);try{let s=await fetch("http://192.168.18.107:3000/rolepermission/api/v1/roles/delete",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({role_id:e})}),a=await s.json();if(401===s.status){console.log("Unauthorized - logging out"),r();return}if(!s.ok||!a.success){let e=handleApiError(a);throw Error(e||"Failed to delete role")}a.success&&1===a.type&&(c(i.filter(t=>t._id!==e)),showMessage("Role deleted successfully!",!0))}catch(t){let e=t instanceof Error?t.message:"Unknown error";showMessage(e,!1),console.error("Error deleting role:",t)}finally{p(!1),y(!1)}},openDeleteModal=e=>{E(e),y(!0)},showMessage=(e,t)=>{h(e),x(t)};return(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 border border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-white mb-2",children:"Manage Roles"}),(0,s.jsx)("form",{onSubmit:handleCreateRole,className:"space-y-3",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:space-x-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-xs text-gray-700 dark:text-gray-300 mb-1",children:"Role Name"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full p-2 text-xs rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter role name"})]}),(0,s.jsx)("div",{className:"mt-4 sm:mt-0 sm:self-end",children:(0,s.jsx)("button",{type:"submit",className:"bg-indigo-500 text-white px-4 py-2 rounded-lg text-xs hover:bg-indigo-600 transition-colors disabled:bg-indigo-300",disabled:f,children:f?"Creating...":"Create Role"})})]})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Existing Roles"}),0===i.length?(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No roles found"}):(0,s.jsx)("ul",{className:"space-y-2",children:i.map(e=>(0,s.jsxs)("li",{className:"flex justify-between items-center p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-800 dark:text-gray-200 text-xs",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsx)("button",{onClick:()=>openDeleteModal(e._id),className:"text-red-500 hover:text-red-700 text-xs disabled:opacity-50",disabled:f,children:(0,s.jsx)(o.Z,{className:"w-4 h-4"})})]},e._id))})]}),b&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg w-80",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Confirm Deletion"}),(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 mb-4",children:"Are you sure you want to delete this role? This action cannot be undone."}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>{E(null),y(!1)},className:"px-3 py-1 text-xs text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{w&&handleDeleteRole(w)},className:"px-3 py-1 text-xs bg-red-500 text-white hover:bg-red-600 rounded-lg disabled:bg-red-300",disabled:f,children:f?"Deleting...":"Delete"})]})]})}),g&&(0,s.jsxs)("div",{className:"fixed bottom-5 right-5 p-3 rounded-lg shadow-lg text-sm flex items-center ".concat(m?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[m?(0,s.jsx)(n.Z,{className:"w-5 h-5 mr-2"}):(0,s.jsx)(l.Z,{className:"w-5 h-5 mr-2"}),(0,s.jsx)("span",{children:g}),(0,s.jsx)("button",{className:"ml-3 text-sm hover:opacity-70",onClick:()=>h(null),children:"âœ•"})]})]})}},50:function(e,t,r){"use strict";var s=r(7294);let a=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=a},6947:function(e,t,r){"use strict";var s=r(7294);let a=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))});t.Z=a},6249:function(e,t,r){"use strict";var s=r(7294);let a=s.forwardRef(function({title:e,titleId:t,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},r),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});t.Z=a}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8734)}),_N_E=e.O()}]);